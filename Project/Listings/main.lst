C51 COMPILER V9.60.0.0   MAIN                                                              01/23/2022 11:39:43 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Source\main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Include) DEFINE(FOSC_16
                    -0000) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          
   2          /*
   3           * Copyright (c) 2021
   4           * VitechSolutions
   5           * All Rights Reserved
   6           *
   7           *
   8           * Description:
   9           *
  10           * Author: TuanNA
  11           *
  12           */
  13          #include "N76E003.h"
  14          #include "Common.h"
  15          #include "Delay.h"
  16          #include "SFR_Macro.h"
  17          #include "Function_define.h"
  18          #include "string.h"
  19          
  20          #define UART0_BAUD 9600
  21          #define UART1_BAUD 9600
  22          
  23          char *motorStart = "MOTOR_START\r\n"; // 12
  24          char *motorStop = "MOTOR_STOP\r\n";   // 11
  25          volatile UINT8 MotorStatus = 0;
  26          volatile UINT8 BeepCount = 0;
  27          
  28          void UART0_SendData(UINT8 *buff, UINT8 len) // USB2COM port
  29          {
  30   1          UINT8 i;
  31   1          for (i = 0; i < len; i++)
  32   1          {
  33   2              Send_Data_To_UART0(buff[i]);
  34   2              Timer2_Delay500us(1);
  35   2          }
  36   1      }
  37          
  38          void main(void)
  39          {
  40   1          P10_Quasi_Mode;
  41   1          InitialUART0_Timer1(UART0_BAUD); // initialization
  42   1          InitialUART1_Timer3(UART1_BAUD);
  43   1          P17_Input_Mode;
  44   1          set_P1S_7;
  45   1          set_IT1;
  46   1          set_EX1;
  47   1          set_ES; // For interrupt enable
  48   1          set_ES_1;
  49   1          set_EA;
  50   1          Timer0_Delay1ms(1000);
  51   1          while (1)
  52   1          {
  53   2              if (BeepCount >= 3 && MotorStatus == 0)
  54   2              {
C51 COMPILER V9.60.0.0   MAIN                                                              01/23/2022 11:39:43 PAGE 2   

  55   3                  clr_ES;
  56   3                  UART0_SendData((UINT8 *)motorStart, strlen(motorStart));
  57   3                  Timer0_Delay1ms(2000);
  58   3                  MotorStatus = 1;
  59   3                  BeepCount = 0;
  60   3                  set_ES;
  61   3              }
  62   2              else if (BeepCount > 0 && MotorStatus == 1)
  63   2              {
  64   3                  clr_ES;
  65   3                  UART0_SendData((UINT8 *)motorStop, strlen(motorStop));
  66   3                  MotorStatus = 0;
  67   3                  BeepCount = 0;
  68   3                  set_ES;
  69   3              }
  70   2          }
  71   1      }
  72          
  73          void SerialPort_ISR(void) interrupt 4
  74          {
  75   1          if (RI)
  76   1          {
  77   2              clr_RI;
  78   2              clr_ES_1;
  79   2              Send_Data_To_UART1(SBUF);
  80   2              set_ES_1;
  81   2          }
  82   1          if (TI)
  83   1          {
  84   2              clr_TI;
  85   2          }
  86   1      }
  87          void SerialPort1_ISR(void) interrupt 15
  88          {
  89   1          if (RI_1)
  90   1          {
  91   2              clr_RI_1;
  92   2              clr_ES;
  93   2              Send_Data_To_UART0(SBUF_1);
  94   2              set_ES;
  95   2          }
  96   1          if (TI_1)
  97   1          {
  98   2              clr_TI_1;
  99   2          }
 100   1      }
 101          
 102          void EXT_INT1(void) interrupt 2
 103          {
 104   1          BeepCount++;
 105   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    401    ----
   CONSTANT SIZE    =     27    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.60.0.0   MAIN                                                              01/23/2022 11:39:43 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
